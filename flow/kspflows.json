[
    {
        "id": "6c281c8f.cbebc4",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": ""
    },
    {
        "id": "388a5b13.29c8f4",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": ""
    },
    {
        "id": "16fa6e68.10eb82",
        "type": "subflow",
        "name": "Lấy dữ từ iNut",
        "info": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "b10e0e64.9d8a1"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 859.0000343322754,
                "y": 98.00000190734863,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 0
                    }
                ]
            },
            {
                "x": 968.0000343322754,
                "y": 102.00000286102295,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 1
                    }
                ]
            },
            {
                "x": 1048.9999732971191,
                "y": 101.00000381469727,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 2
                    }
                ]
            },
            {
                "x": 1116.9999732971191,
                "y": 112.00000381469727,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 3
                    }
                ]
            },
            {
                "x": 1178.0000820159912,
                "y": 129.0000057220459,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 4
                    }
                ]
            },
            {
                "x": 1216.0000820159912,
                "y": 188.0000057220459,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 5
                    }
                ]
            },
            {
                "x": 1189.0000839233398,
                "y": 263.00000762939453,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 6
                    }
                ]
            },
            {
                "x": 1173.9999742507935,
                "y": 312.00000762939453,
                "wires": [
                    {
                        "id": "f5a4c5c2.980f98",
                        "port": 7
                    }
                ]
            }
        ],
        "inputLabels": [
            "Nhận đầu vào MQTT IN từ iNut cảm biến"
        ],
        "outputLabels": [
            "Luồng cảm biến 1",
            "Luồng cảm biến 2",
            "Luồng cảm biến 3",
            "Luồng cảm biến 4",
            "Luồng cảm biến 5",
            "Luồng cảm biến 6",
            "Luồng cảm biến 7",
            "Luồng cảm biến 8"
        ]
    },
    {
        "id": "78b6290f.001d28",
        "type": "subflow",
        "name": "Byte => Array of 8 bits",
        "info": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "bf5700a3.22a89"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 160,
                "y": 30,
                "wires": [
                    {
                        "id": "bf5700a3.22a89",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "659b0f2f.cf2f8",
        "type": "subflow",
        "name": "Chuẩn bị lệnh đến iNut cảm biến",
        "info": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "dae9d9f7.344a98"
                    },
                    {
                        "id": "1171136b.8c349d"
                    },
                    {
                        "id": "5e5205f2.c00b0c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 723.7500076293945,
                "y": 236.24999809265137,
                "wires": [
                    {
                        "id": "dae9d9f7.344a98",
                        "port": 0
                    }
                ]
            },
            {
                "x": 724.9999885559082,
                "y": 283.75000190734863,
                "wires": [
                    {
                        "id": "1171136b.8c349d",
                        "port": 0
                    }
                ]
            },
            {
                "x": 724.9999847412109,
                "y": 330.00002670288086,
                "wires": [
                    {
                        "id": "5e5205f2.c00b0c",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "3d854388.3dd92c",
        "type": "subflow",
        "name": "Chuẩn bị lệnh cập nhập giá trị",
        "info": "",
        "in": [
            {
                "x": 50,
                "y": 30,
                "wires": [
                    {
                        "id": "e08c24db.4e6ce8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 762.5000076293945,
                "y": 127.49999809265137,
                "wires": [
                    {
                        "id": "1ca4a1db.57538e",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "f6e14664.ebf688",
        "type": "mqtt-broker",
        "z": "",
        "name": "",
        "broker": "ourshark.mysmarthome.vn",
        "port": "8097",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "e3ed5d37.01305",
        "type": "mqtt-broker",
        "z": "",
        "name": "",
        "broker": "mqtt.mysmarthome.vn",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "f4134e17.6b60a",
        "type": "ui_base",
        "theme": {
            "name": "theme-custom",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0c9ec2",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#4B7930",
                    "value": "#4B7930",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#4B7930",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#000000",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#6db046",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#4b7930",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            }
        },
        "site": {
            "name": "iNut Platform Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 78,
                "sy": 78,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "294eb87b.b71b48",
        "type": "ui_tab",
        "z": "",
        "name": "Giao diện bãi đỗ xe",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "2205c075.fa443",
        "type": "ui_group",
        "z": "",
        "name": "Test",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "52cad39c.c8472c",
        "type": "ui_group",
        "z": "",
        "name": "Bãi đỗ xe",
        "tab": "294eb87b.b71b48",
        "order": 1,
        "disp": false,
        "width": "12",
        "collapse": false
    },
    {
        "id": "81dc1f08.a421b",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt.mysmarthome.vn",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "aa1345ad.c2b128",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt.mysmarthome.vn",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "1f06d15b.70df1f",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt.mysmarthome.vn",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "40c8bc47.1cb534",
        "type": "ui_group",
        "z": "",
        "name": "Thanh thông tin",
        "tab": "294eb87b.b71b48",
        "order": 2,
        "disp": false,
        "width": "3",
        "collapse": false
    },
    {
        "id": "e82d4b96.cfe248",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt.mysmarthome.vn",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": true,
        "keepalive": "60",
        "cleansession": true,
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": ""
    },
    {
        "id": "1db9289c.2fadd7",
        "type": "ui_group",
        "z": "",
        "name": "Group 3",
        "tab": "294eb87b.b71b48",
        "order": 3,
        "disp": true,
        "width": "3",
        "collapse": false
    },
    {
        "id": "f744068b.e03678",
        "type": "ui_group",
        "z": "",
        "name": "Group 4",
        "tab": "294eb87b.b71b48",
        "order": 4,
        "disp": true,
        "width": "3",
        "collapse": false
    },
    {
        "id": "b10e0e64.9d8a1",
        "type": "json",
        "z": "16fa6e68.10eb82",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 165,
        "y": 84,
        "wires": [
            [
                "1e1494ef.cac0fb"
            ]
        ]
    },
    {
        "id": "f5a4c5c2.980f98",
        "type": "switch",
        "z": "16fa6e68.10eb82",
        "name": "Phân luồn",
        "property": "relayId",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "3",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "4",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "5",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "6",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "7",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 8,
        "x": 825.9869575500488,
        "y": 288.1562738418579,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "86d47f8c.ade7a",
        "type": "function",
        "z": "16fa6e68.10eb82",
        "name": "Chuỗi => Số",
        "func": "if (!msg.noInt)\n    msg.payload = parseInt(msg.payload, 10)\nelse\n    msg.payload = parseFloat(msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 578.8906364440918,
        "y": 314.3359966278076,
        "wires": [
            []
        ]
    },
    {
        "id": "1e1494ef.cac0fb",
        "type": "function",
        "z": "16fa6e68.10eb82",
        "name": "Lặp",
        "func": "if (!msg.states) {\n    msg.states = msg.payload\n    msg.i = 0\n    return msg;\n} else {\n    msg.i++\n    \n    if (msg.i < msg.states.length)\n        return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 327.89060974121094,
        "y": 83.33600330352783,
        "wires": [
            [
                "c3a97343.a2626"
            ]
        ]
    },
    {
        "id": "c3a97343.a2626",
        "type": "function",
        "z": "16fa6e68.10eb82",
        "name": "Lấy trạng thái thiết bị",
        "func": "msg.relayId = msg.i\nmsg.payload = msg.states[msg.i].state\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 477.89060974121094,
        "y": 183.33600330352783,
        "wires": [
            [
                "1e1494ef.cac0fb",
                "f5a4c5c2.980f98"
            ]
        ]
    },
    {
        "id": "a49ad212.1f758",
        "type": "subflow:16fa6e68.10eb82",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "x": 541,
        "y": 838.0000076293945,
        "wires": [
            [
                "7f30ad91.1254d4"
            ],
            [
                "781603bc.9f35cc"
            ],
            [
                "1ae6155e.5f474b"
            ],
            [
                "647839d5.4e93f8"
            ],
            [
                "12305be.a1a9aa4"
            ],
            [
                "473111fd.bd758"
            ],
            [
                "725bba7a.ed16e4"
            ],
            [
                "2fbf646e.09ab1c"
            ]
        ]
    },
    {
        "id": "6575ca16.ce8344",
        "type": "debug",
        "z": "6c281c8f.cbebc4",
        "name": " D101",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "info",
        "x": 1376.0965518951416,
        "y": 781.1510496139526,
        "wires": []
    },
    {
        "id": "f612d082.8f2d7",
        "type": "inject",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 153.0989761352539,
        "y": 466.9244899749756,
        "wires": [
            [
                "59600490.c4a9ec"
            ]
        ]
    },
    {
        "id": "59600490.c4a9ec",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "Bộ test 1 - TEST bố trí xe",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[{\"node_id\":\"r1O92dtSz\",\"id\":0,\"state\":\"7.00\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":1,\"state\":\"7.00\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":2,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":3,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":4,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":5,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":6,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":7,\"state\":\"6\",\"type\":\"SENSOR\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 391.10419845581055,
        "y": 518.2291450500488,
        "wires": [
            [
                "8a20351c.579cb8"
            ]
        ]
    },
    {
        "id": "8a20351c.579cb8",
        "type": "json",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "property": "payload",
        "action": "str",
        "pretty": false,
        "x": 340.1015625,
        "y": 699.0208282470703,
        "wires": [
            [
                "a49ad212.1f758"
            ]
        ]
    },
    {
        "id": "bf5700a3.22a89",
        "type": "function",
        "z": "78b6290f.001d28",
        "name": "Chuyển byte => mảng 8 bit để dễ xử lý",
        "func": "\nvar ids = msg.info.ids\nvar int = parseInt(msg.payload, 10)\nfor (var i = 0; i < 8; i++) {\n    \n    \n    ids.push((int >> i) & 1)\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 204.01303100585938,
        "y": 154.0104217529297,
        "wires": [
            []
        ]
    },
    {
        "id": "867432bf.a3d78",
        "type": "subflow:78b6290f.001d28",
        "z": "6c281c8f.cbebc4",
        "x": 1172.098991394043,
        "y": 825.4530353546143,
        "wires": [
            [
                "6575ca16.ce8344",
                "6a08452b.c3e50c"
            ]
        ]
    },
    {
        "id": "7f30ad91.1254d4",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D101, vị trí 8 xe đầu",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"car_position\",\"index\":0,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 851.1016159057617,
        "y": 676.203088760376,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "781603bc.9f35cc",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D102, vị trí 8 xe sau",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"car_position\",\"index\":4,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 849.8464584350586,
        "y": 715.0103759765625,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "1ae6155e.5f474b",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D103, đường đi, cột 1",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"column\",\"index\":1,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 848.3464050292969,
        "y": 757.0103969573975,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "647839d5.4e93f8",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D104, đường đi, cột 3",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"column\",\"index\":3,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 847.346435546875,
        "y": 797.0104293823242,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "12305be.a1a9aa4",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D105, đường đi, cột 5",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"column\",\"index\":5,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 845.3464050292969,
        "y": 840.0103969573975,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "473111fd.bd758",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D106, đường đi, dòng 1",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"row\",\"index\":1,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 855.3464050292969,
        "y": 885.0103969573975,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "725bba7a.ed16e4",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "D107, đường đi, dòng 5",
        "rules": [
            {
                "t": "set",
                "p": "info",
                "pt": "msg",
                "to": "{\"type\":\"row\",\"index\":5,\"ids\":[]}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 853.3464050292969,
        "y": 926.0103969573975,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "2fbf646e.09ab1c",
        "type": "ui_gauge",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "group": "40c8bc47.1cb534",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Số lượng xe",
        "label": "xe",
        "format": "{{value}}",
        "min": 0,
        "max": "16",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "8",
        "seg2": "13",
        "x": 822.4349365234375,
        "y": 976.0259780883789,
        "wires": []
    },
    {
        "id": "f153a439.4b2aa8",
        "type": "ui_template",
        "z": "6c281c8f.cbebc4",
        "group": "52cad39c.c8472c",
        "name": "Giao diện bãi đỗ xe",
        "order": 1,
        "width": "12",
        "height": "10",
        "format": "<div class=\"container\">\n  <div class=\"row\" ng-repeat = \"row in msg.matrix track by $index\">\n    <div class=\"col\" ng-class=\"data.class\" ng-repeat=\"data in row track by $index\">\n        <img  src=\"http://sv1.upsieutoc.com/2018/05/28/2331b9aba9e4f7f15ac6c5e4918bd2e14e56.png\" ng-if=\"data.class == 'co-xe' && data.type == 'car_position'\" style=\"width: 100px;\" />\n    </div>\n  </div>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1686.6016693115234,
        "y": 878.8958797454834,
        "wires": [
            []
        ]
    },
    {
        "id": "a8d65f33.26615",
        "type": "ui_template",
        "z": "6c281c8f.cbebc4",
        "group": "52cad39c.c8472c",
        "name": "Bootstrap",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\" integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\" crossorigin=\"anonymous\">\n<script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\" integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js\" integrity=\"sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49\" crossorigin=\"anonymous\"></script>\n<script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js\" integrity=\"sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T\" crossorigin=\"anonymous\"></script>\n<style>\n    .row {\n        background: #F0F0F0;\n        height: 100px;\n        color: black;\n    }\n    .co-xe {\n        \n        \n        background: url(\"http://sv1.upsieutoc.com/2018/05/28/nen-duong-abc.png\");\n    }   \n    .ko-co-xe {\n        background: grey;\n    }\n    .duong-ko-co-xe {\n        background: url(\"http://sv1.upsieutoc.com/2018/05/10/duong.png\");\n    }\n    .duong-co-xe {\n        background: url(\"http://sv1.upsieutoc.com/2018/05/10/duong3.png\");\n    }\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "global",
        "x": 1385.6797180175781,
        "y": 829.0103769302368,
        "wires": [
            []
        ]
    },
    {
        "id": "6a08452b.c3e50c",
        "type": "function",
        "z": "6c281c8f.cbebc4",
        "name": "Định hướng ra ma trận 8x7",
        "func": "msg.matrix = global.get(\"matrix\") || [[],[],[],[],[],[],[], []]\nif (msg.info.type == \"car_position\") {\n    var index = msg.info.index\n    var column = 0\n    msg.info.ids.map(function(state, idx) {\n        if (idx == 4) {\n            index += 2\n            column = 0\n        }\n        msg.matrix[index][column] = msg.matrix[index][column] || {}\n        msg.matrix[index][column].type = msg.info.type        \n        if (state == 1) {\n            msg.matrix[index][column].class = \"co-xe\" \n        } else {\n            msg.matrix[index][column].class = \"ko-co-xe\"\n        }\n        \n        column += 2\n    })\n} else if (msg.info.type == \"row\") {\n    var index = msg.info.index\n    var column = 0\n    msg.info.ids.map(function(state, idx) {\n        if (idx == 4) {\n            index += 2\n            column = 0\n        }\n        msg.matrix[index][column] = msg.matrix[index][column] || {}\n        msg.matrix[index][column].type = msg.info.type        \n        if (state == 1) {\n            msg.matrix[index][column].class = \"duong-co-xe\" \n        } else {\n            msg.matrix[index][column].class = \"duong-ko-co-xe\"\n        }\n        \n        column += 2\n    })\n} else if (msg.info.type == \"column\") {\n    var index = msg.info.index\n    msg.info.ids.map(function(state, idx) {\n        msg.matrix[idx][index] = msg.matrix[idx][index] || {}\n        msg.matrix[idx][index].type = msg.info.type        \n        if (state == 1) {\n            msg.matrix[idx][index].class = \"duong-co-xe\" \n        } else {\n            msg.matrix[idx][index].class = \"duong-ko-co-xe\"\n        }\n    })\n}\nglobal.set(\"matrix\", msg.matrix)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1447.9444389343262,
        "y": 879.1111040115356,
        "wires": [
            [
                "f153a439.4b2aa8",
                "3763e70.6b54d1a"
            ]
        ]
    },
    {
        "id": "3763e70.6b54d1a",
        "type": "debug",
        "z": "6c281c8f.cbebc4",
        "name": "Matrix",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "matrix",
        "x": 1648.1110954284668,
        "y": 815.5555477142334,
        "wires": []
    },
    {
        "id": "29b5d81f.b47e88",
        "type": "inject",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 595.388916015625,
        "y": 423.98612213134766,
        "wires": [
            [
                "56b49c8c.7a1084"
            ]
        ]
    },
    {
        "id": "56b49c8c.7a1084",
        "type": "function",
        "z": "6c281c8f.cbebc4",
        "name": "Reset matrix",
        "func": "global.set(\"matrix\", [[],[],[],[],[],[],[]])\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 753.38889503479,
        "y": 424.7638988494873,
        "wires": [
            [
                "867432bf.a3d78"
            ]
        ]
    },
    {
        "id": "a1df0c67.0ced3",
        "type": "inject",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 132,
        "y": 509,
        "wires": [
            [
                "59600490.c4a9ec"
            ]
        ]
    },
    {
        "id": "45bd5f5b.a1ea7",
        "type": "inject",
        "z": "6c281c8f.cbebc4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 109,
        "y": 560,
        "wires": [
            [
                "4ff871ca.a3576"
            ]
        ]
    },
    {
        "id": "4ff871ca.a3576",
        "type": "change",
        "z": "6c281c8f.cbebc4",
        "name": "Bộ test 2 - TEST đường đi",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "[{\"node_id\":\"r1O92dtSz\",\"id\":0,\"state\":\"7.00\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":1,\"state\":\"7.00\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":2,\"state\":\"254.00\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":3,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":4,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":5,\"state\":\"1\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":6,\"state\":\"0\",\"type\":\"SENSOR\"},{\"node_id\":\"r1O92dtSz\",\"id\":7,\"state\":\"6.0\",\"type\":\"SENSOR\"}]",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 309,
        "y": 560.0000038146973,
        "wires": [
            [
                "8a20351c.579cb8"
            ]
        ]
    },
    {
        "id": "4ae49f7d.4dd2e",
        "type": "mqtt in",
        "z": "6c281c8f.cbebc4",
        "name": "[MQTT-IN]Phòng máy",
        "topic": "request/5goE0liD7uhCqKpfIIg1pid9ZE02/SygzGltCM/41c58f24dd86aa858cf357cabafd0a25320347499814",
        "qos": "2",
        "broker": "e82d4b96.cfe248",
        "x": 306,
        "y": 839,
        "wires": [
            [
                "a49ad212.1f758"
            ]
        ]
    },
    {
        "id": "6ffff32e.97137c",
        "type": "debug",
        "z": "659b0f2f.cf2f8",
        "name": "in ra màn hình để debug thông tin",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 746.2345199584961,
        "y": 136.29917907714844,
        "wires": []
    },
    {
        "id": "dae9d9f7.344a98",
        "type": "function",
        "z": "659b0f2f.cf2f8",
        "name": "Chuẩn bị lệnh trước khi gửi đến iNut cảm biến",
        "func": "var json = {\"id\": 0, \"command\": msg.payload};\nmsg.payload = json;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 307.9870300292969,
        "y": 135.05675411224365,
        "wires": [
            [
                "6ffff32e.97137c"
            ]
        ]
    },
    {
        "id": "5e5205f2.c00b0c",
        "type": "function",
        "z": "659b0f2f.cf2f8",
        "name": "Lấy độ dài chuỗi",
        "func": "\nmsg.payload =  msg.payload.length;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 207.5,
        "y": 216.733660697937,
        "wires": [
            []
        ]
    },
    {
        "id": "1171136b.8c349d",
        "type": "function",
        "z": "659b0f2f.cf2f8",
        "name": "Lấy đoạn chuỗi mà Arduino nhận được",
        "func": "\nmsg.payload =  msg.payload.substr(0, 32);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 275.6200408935547,
        "y": 175.36904048919678,
        "wires": [
            []
        ]
    },
    {
        "id": "1ca4a1db.57538e",
        "type": "subflow:659b0f2f.cf2f8",
        "z": "3d854388.3dd92c",
        "name": "",
        "x": 528.7471542358398,
        "y": 127.54917907714844,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "e08c24db.4e6ce8",
        "type": "function",
        "z": "3d854388.3dd92c",
        "name": "Chuyển sang chuẩn lệnh",
        "func": "var state = parseInt(msg.payload, 10)\nmsg.payload = {\n    \"p\": msg.topic,\n    \"s\": state,\n    \"c\": 2 //gửi lệnh sửa giá trị thanh ghi\n}\nmsg.payload = JSON.stringify(msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 216.25001525878906,
        "y": 97.35532474517822,
        "wires": [
            [
                "1ca4a1db.57538e"
            ]
        ]
    },
    {
        "id": "4a26706b.38b6a",
        "type": "http request",
        "z": "388a5b13.29c8f4",
        "name": "[REST][POST]Phòng máy",
        "method": "POST",
        "ret": "txt",
        "url": "https://connect.mysmarthome.vn/api/1.0/request/5goE0liD7uhCqKpfIIg1pid9ZE02/SygzGltCM/41c58f24dd86aa858cf357cabafd0a25320347499814/req_device_toggle",
        "tls": "",
        "x": 918,
        "y": 166,
        "wires": [
            []
        ]
    },
    {
        "id": "61a21e9d.ea04c",
        "type": "subflow:3d854388.3dd92c",
        "z": "388a5b13.29c8f4",
        "name": "",
        "x": 640,
        "y": 171,
        "wires": [
            [
                "4a26706b.38b6a"
            ]
        ]
    },
    {
        "id": "f5174dc4.10ea2",
        "type": "change",
        "z": "388a5b13.29c8f4",
        "name": "4 xe",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "4",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "108",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 131,
        "wires": [
            [
                "61a21e9d.ea04c"
            ]
        ]
    },
    {
        "id": "ee24eac5.b648e8",
        "type": "change",
        "z": "388a5b13.29c8f4",
        "name": "Test D104 - 124",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "124",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "104",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 231,
        "wires": [
            [
                "61a21e9d.ea04c"
            ]
        ]
    },
    {
        "id": "ff6cb607.716818",
        "type": "inject",
        "z": "388a5b13.29c8f4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 244,
        "y": 128,
        "wires": [
            [
                "f5174dc4.10ea2"
            ]
        ]
    },
    {
        "id": "1459a26.4be9f5e",
        "type": "inject",
        "z": "388a5b13.29c8f4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 247,
        "y": 228,
        "wires": [
            [
                "ee24eac5.b648e8"
            ]
        ]
    },
    {
        "id": "15fd2fd7.f04a8",
        "type": "change",
        "z": "388a5b13.29c8f4",
        "name": "Test D101 - 222",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "222",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "101",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 425,
        "y": 284,
        "wires": [
            [
                "61a21e9d.ea04c"
            ]
        ]
    },
    {
        "id": "1d6c7596.3efc1a",
        "type": "inject",
        "z": "388a5b13.29c8f4",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 241,
        "y": 286,
        "wires": [
            [
                "15fd2fd7.f04a8",
                "15a70247.a2a53e"
            ]
        ]
    },
    {
        "id": "1338d5e7.19cc5a",
        "type": "ui_button",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "40c8bc47.1cb534",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Thử nghiệm 1",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 198,
        "y": 348,
        "wires": [
            [
                "15a70247.a2a53e"
            ]
        ]
    },
    {
        "id": "15a70247.a2a53e",
        "type": "change",
        "z": "388a5b13.29c8f4",
        "name": "Test D102 - 169",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "169",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "102",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 415,
        "y": 348,
        "wires": [
            [
                "61a21e9d.ea04c"
            ]
        ]
    },
    {
        "id": "6876e112.61af8",
        "type": "ui_button",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "40c8bc47.1cb534",
        "order": 3,
        "width": "3",
        "height": "2",
        "passthru": false,
        "label": "Thử nghiệm 2",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 205,
        "y": 184,
        "wires": [
            [
                "f5174dc4.10ea2"
            ]
        ]
    },
    {
        "id": "5f49841c.71a17c",
        "type": "subflow:16fa6e68.10eb82",
        "z": "388a5b13.29c8f4",
        "name": "admin",
        "x": 406,
        "y": 497,
        "wires": [
            [
                "859fa311.bdd29"
            ],
            [
                "507956f8.ae0f98"
            ],
            [
                "199336dc.2ebab9"
            ],
            [
                "61c9683d.736028"
            ],
            [
                "db93cc9e.9d41"
            ],
            [],
            [],
            []
        ]
    },
    {
        "id": "ba47eec0.5170b",
        "type": "mqtt in",
        "z": "388a5b13.29c8f4",
        "name": "[MQTT-IN]Phòng máy",
        "topic": "request/5goE0liD7uhCqKpfIIg1pid9ZE02/SygzGltCM/41c58f24dd86aa858cf357cabafd0a25320347499814",
        "qos": "2",
        "broker": "e82d4b96.cfe248",
        "x": 157,
        "y": 497.99999237060547,
        "wires": [
            [
                "5f49841c.71a17c"
            ]
        ]
    },
    {
        "id": "859fa311.bdd29",
        "type": "ui_gauge",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "1db9289c.2fadd7",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "d101",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "255",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 655,
        "y": 406,
        "wires": []
    },
    {
        "id": "507956f8.ae0f98",
        "type": "ui_gauge",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "1db9289c.2fadd7",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "d102",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "255",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 665,
        "y": 459,
        "wires": []
    },
    {
        "id": "db93cc9e.9d41",
        "type": "ui_gauge",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "f744068b.e03678",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "d105",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "255",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 665,
        "y": 594,
        "wires": []
    },
    {
        "id": "199336dc.2ebab9",
        "type": "ui_gauge",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "1db9289c.2fadd7",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "d103",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "255",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 657,
        "y": 508,
        "wires": []
    },
    {
        "id": "61c9683d.736028",
        "type": "ui_gauge",
        "z": "388a5b13.29c8f4",
        "name": "",
        "group": "f744068b.e03678",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "d104",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": "255",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 662,
        "y": 550,
        "wires": []
    },
    {
        "id": "33689673.3f311a",
        "type": "debug",
        "z": "388a5b13.29c8f4",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 951,
        "y": 307,
        "wires": []
    }
]